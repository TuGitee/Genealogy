{"version":3,"file":"Branch-yYb-xIez.js","sources":["../../src/icons/FoldIcon.vue","../../src/icons/OpenIcon.vue","../../src/icons/MaleIcon.vue","../../src/icons/FemaleIcon.vue","../../src/components/Modal.vue","../../src/components/PersonCard.vue","../../src/components/PersonItem.vue","../../src/icons/BackIcon.vue","../../src/icons/SearchIcon.vue","../../src/views/Branch.vue"],"sourcesContent":["<template>\r\n  <svg\r\n    t=\"1707551930411\"\r\n    class=\"icon\"\r\n    viewBox=\"0 0 1024 1024\"\r\n    version=\"1.1\"\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    p-id=\"4400\"\r\n    width=\"16\"\r\n    height=\"16\"\r\n  >\r\n    <path\r\n      d=\"M131.11 192.37m32.17 0l700.08 0q32.17 0 32.17 32.17l0 0q0 32.17-32.17 32.17l-700.08 0q-32.17 0-32.17-32.17l0 0q0-32.17 32.17-32.17Z\"\r\n      fill=\"#2c2c2c\"\r\n      p-id=\"4401\"\r\n    ></path>\r\n    <path\r\n      d=\"M131.11 766.83m32.17 0l700.08 0q32.17 0 32.17 32.17l0 0q0 32.17-32.17 32.17l-700.08 0q-32.17 0-32.17-32.17l0 0q0-32.17 32.17-32.17Z\"\r\n      fill=\"#2c2c2c\"\r\n      p-id=\"4402\"\r\n    ></path>\r\n    <path\r\n      d=\"M449.33 385.09m32.17 0l381.87 0q32.17 0 32.17 32.17l0 0q0 32.17-32.17 32.17l-381.87 0q-32.17 0-32.17-32.17l0 0q0-32.17 32.17-32.17Z\"\r\n      fill=\"#2c2c2c\"\r\n      p-id=\"4403\"\r\n    ></path>\r\n    <path\r\n      d=\"M449.33 578.11m32.17 0l381.87 0q32.17 0 32.17 32.17l0 0q0 32.17-32.17 32.17l-381.87 0q-32.17 0-32.17-32.17l0 0q0-32.17 32.17-32.17Z\"\r\n      fill=\"#2c2c2c\"\r\n      p-id=\"4404\"\r\n    ></path>\r\n    <path\r\n      d=\"M129.91 512.16L321.14 639.7V384.62L129.91 512.16z\"\r\n      fill=\"#2c2c2c\"\r\n      p-id=\"4405\"\r\n    ></path>\r\n  </svg>\r\n</template>\r\n\r\n<style scoped lang=\"scss\">\r\npath {\r\n  fill: var(--gray-900);\r\n}\r\n</style>\r\n","<template>\r\n  <svg\r\n    t=\"1707620551337\"\r\n    class=\"icon\"\r\n    viewBox=\"0 0 1024 1024\"\r\n    version=\"1.1\"\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    p-id=\"4227\"\r\n    width=\"16\"\r\n    height=\"16\"\r\n  >\r\n    <path\r\n      d=\"M937.387 488.107L772.267 372.48c-12.8-9.387-30.294-6.827-40.107 5.547-3.84 4.693-5.547 10.666-5.547 17.066v233.814c0 22.613 25.6 36.693 45.654 22.613l165.546-115.627c14.08-14.08 14.08-36.693-0.426-47.786z m-23.04-274.774H129.28c-18.773 0-34.133-15.36-34.133-34.133s15.36-34.133 34.133-34.133h785.067c18.773 0 34.133 15.36 34.133 34.133s-14.933 34.133-34.133 34.133z m0 665.6H129.28c-18.773 0-34.133-15.36-34.133-34.133s15.36-34.133 34.133-34.133h785.067c18.773 0 34.133 15.36 34.133 34.133s-14.933 34.133-34.133 34.133zM624.213 435.2H129.28c-18.773 0-34.133-15.36-34.133-34.133s15.36-34.134 34.133-34.134h494.933c18.774 0 34.134 15.36 34.134 34.134S643.413 435.2 624.213 435.2z m0.427 221.867H129.28c-18.773 0-34.133-15.36-34.133-34.134s15.36-34.133 34.133-34.133h495.36c18.773 0 34.133 15.36 34.133 34.133v0.427c-0.426 18.347-15.36 33.707-34.133 33.707z\"\r\n      fill=\"#2c2c2c\"\r\n      p-id=\"4228\"\r\n    ></path>\r\n  </svg>\r\n</template>\r\n\r\n<style scoped lang=\"scss\">\r\npath {\r\n  fill: var(--gray-900);\r\n}\r\n</style>\r\n","<template>\r\n  <svg\r\n    width=\"10\"\r\n    height=\"10\"\r\n    fill=\"none\"\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    viewBox=\"0 0 12 12\"\r\n    style=\"margin-right: 4px\"\r\n  >\r\n    <path\r\n      fill-rule=\"evenodd\"\r\n      clip-rule=\"evenodd\"\r\n      d=\"M8 1.25a.75.75 0 000 1.5h1.09L7.54 4.298a.757.757 0 00-.058.066 4 4 0 10.968 1.112.752.752 0 00.15-.117L10.25 3.71V5a.75.75 0 001.5 0V2a.75.75 0 00-.75-.75H8zM5 10a2.5 2.5 0 100-5 2.5 2.5 0 000 5z\"\r\n      fill=\"#168EF9\"\r\n    ></path>\r\n  </svg>\r\n</template>\r\n","<template>\r\n  <svg\r\n    width=\"10\"\r\n    height=\"10\"\r\n    fill=\"none\"\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    viewBox=\"0 0 12 12\"\r\n    style=\"margin-right: 4px\"\r\n  >\r\n    <mask\r\n      id=\"woman_svg__a\"\r\n      maskUnits=\"userSpaceOnUse\"\r\n      x=\"-4\"\r\n      y=\"-4\"\r\n      width=\"16\"\r\n      height=\"16\"\r\n      style=\"mask-type: alpha\"\r\n    >\r\n      <path fill=\"#C4C4C4\" d=\"M-2-2h16v16H-2z\"></path>\r\n    </mask>\r\n    <g\r\n      mask=\"url(#woman_svg__a)\"\r\n      stroke=\"#F5588E\"\r\n      stroke-width=\"1.5\"\r\n      stroke-linecap=\"round\"\r\n      stroke-linejoin=\"round\"\r\n    >\r\n      <circle cx=\"7.2\" cy=\"4.896\" r=\"3.25\"></circle>\r\n      <path d=\"M1.617 10.511l3.115-3.115M1.904 7.396l2.828 2.829\"></path>\r\n    </g>\r\n  </svg>\r\n</template>\r\n","<template>\r\n  <Teleport to=\"body\">\r\n    <div class=\"modal\" @click.self=\"close\">\r\n      <div class=\"container\">\r\n        <slot name=\"header\">\r\n          <h3 class=\"title\">详细信息</h3>\r\n        </slot>\r\n        <div class=\"body\">\r\n          <slot name=\"body\"></slot>\r\n        </div>\r\n        <slot name=\"footer\">\r\n          <button @click=\"close\" class=\"btn\">确认</button>\r\n        </slot>\r\n      </div>\r\n    </div>\r\n  </Teleport>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { onBeforeUnmount, onMounted } from \"vue\";\r\n\r\ndefineProps<{ open: boolean }>();\r\nconst emit = defineEmits([\"close\"]);\r\nfunction close() {\r\n  emit(\"close\");\r\n}\r\nonMounted(() => {\r\n  (document.querySelector(\"#container\") as HTMLDivElement).style.overflow =\r\n    \"hidden\";\r\n});\r\n\r\nonBeforeUnmount(() => {\r\n  (document.querySelector(\"#container\") as HTMLDivElement).style.overflow =\r\n    \"auto\";\r\n});\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.modal {\r\n  position: fixed;\r\n  top: 0;\r\n  left: 0;\r\n  width: 100%;\r\n  height: 100%;\r\n  border: unset;\r\n  background-color: var(--mask);\r\n\r\n  .container {\r\n    position: absolute;\r\n    z-index: 999;\r\n    padding: var(--padding);\r\n    border-radius: var(--radius);\r\n    display: flex;\r\n    flex-direction: column;\r\n    gap: calc(var(--padding) / 10);\r\n    top: 50%;\r\n    left: 50%;\r\n    max-width: 420px;\r\n    width: 40%;\r\n    min-width: 300px;\r\n    transform: translate(-50%, -50%);\r\n    background-color: var(--gray-100);\r\n\r\n    .body {\r\n      max-height: 50vh;\r\n      overflow-y: auto;\r\n      overflow-x: hidden;\r\n    }\r\n\r\n    .title {\r\n      margin-bottom: 8px;\r\n    }\r\n\r\n    .btn {\r\n      display: block;\r\n      margin-top: calc(var(--padding));\r\n      margin-bottom: calc(var(--padding) / 4);\r\n      background: linear-gradient(135deg, var(--gray-600), var(--gray-700));\r\n      padding: 8px 0;\r\n      width: 100%;\r\n      font-size: 12px;\r\n      color: var(--gray-100);\r\n      border-radius: var(--radius);\r\n      border: unset;\r\n\r\n      &:hover {\r\n        filter: brightness(1.1);\r\n      }\r\n\r\n      &:active {\r\n        filter: brightness(0.9);\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n","<template>\r\n  <article\r\n    :class=\"[\r\n      item.gender ? 'male' : 'female',\r\n      item.current ? 'current' : '',\r\n      item.die ? 'die' : '',\r\n    ]\"\r\n    @click=\"open = true\"\r\n  >\r\n    <header>\r\n      <span class=\"name\" v-text=\"item.name\"></span\r\n      ><span v-if=\"item.pname\" class=\"pname\" v-text=\"item.pname\"></span>\r\n    </header>\r\n    <body>\r\n      <span class=\"item\" v-if=\"item.level\">第{{ item.level }}世</span>\r\n      <span class=\"item\"\r\n        ><GenderIcon :gender=\"!!item.gender\"></GenderIcon>\r\n        <span v-if=\"item.age\"> {{ item.age }}岁</span>\r\n        <span v-else>{{ genderName(item.gender!) }}</span>\r\n      </span>\r\n      <span class=\"item\" v-if=\"item.origin\">{{ item.origin }}</span>\r\n      <span class=\"item\" v-if=\"item.lunarBirthDay?.slice(5)\">{{\r\n        item.lunarBirthDay.slice(5)\r\n      }}</span>\r\n      <span class=\"item\" v-for=\"tag in item.tags\">{{ tag }}</span>\r\n    </body>\r\n    <footer>\r\n      <p v-if=\"item.lunarBirthDay\">\r\n        出生年份: {{ item.lunarBirthDay.slice(0, 4) }}年\r\n      </p>\r\n      <p v-if=\"item.phone\">\r\n        联系电话:\r\n        <a :href=\"`tel:${item.phone}`\" @click.stop>{{ item.phone }}</a>\r\n      </p>\r\n    </footer>\r\n  </article>\r\n\r\n  <Modal v-if=\"open\" :open=\"open\" @close=\"open = false\">\r\n    <template #body>\r\n      <p class=\"name\"><span class=\"align\">姓名</span>: {{ item.name }}</p>\r\n      <p class=\"level\" v-if=\"item.level\">\r\n        <span class=\"align\">世代</span>: 第{{ item.level }}世\r\n      </p>\r\n      <p class=\"pname\" v-if=\"item.pname\">\r\n        <span class=\"align\">乳名</span>: {{ item.pname }}\r\n      </p>\r\n      <p class=\"gender\">\r\n        <span class=\"align\">性别</span>: {{ genderName(item.gender!) }}\r\n      </p>\r\n      <p class=\"mate\" v-if=\"item.mate\">\r\n        <span class=\"align\">配偶</span>:\r\n        {{\r\n          Array.isArray(item.mate)\r\n            ? item.mate.map((mate: PersonInfo) => mate.name).join(\"、\")\r\n            : item.mate.name\r\n        }}\r\n      </p>\r\n      <p class=\"age\" v-if=\"item.age\">\r\n        <span class=\"align\">虚岁</span>: {{ item.age }}岁\r\n      </p>\r\n      <p class=\"birthYear\" v-if=\"item.lunarBirthDay\">\r\n        <span class=\"align\">出生日期</span>: {{ item.lunarBirthDay }}\r\n      </p>\r\n      <p class=\"origin\" v-if=\"item.origin\">\r\n        <span class=\"align\">来自</span>: {{ item.origin }}\r\n      </p>\r\n      <p class=\"phone\" v-if=\"item.phone\">\r\n        <span class=\"align\">联系电话</span>:\r\n        <a :href=\"`tel:${item.phone}`\">{{ item.phone }}</a>\r\n      </p>\r\n      <p class=\"wechat\" v-if=\"item.phone\">\r\n        <span class=\"align\">微信</span>:\r\n        <a href=\"weixin://\" @click=\"copy(item.phone)\">{{ item.phone }} </a>\r\n      </p>\r\n      <p class=\"tags\" v-if=\"item.tags\">\r\n        <span class=\"align\">其他信息</span>: {{ item.tags.join(\"、\") }}\r\n      </p>\r\n      <div class=\"image-container\" v-if=\"item.image\">\r\n        <img\r\n          :src=\"item.image\"\r\n          alt=\"avatar\"\r\n          class=\"image\"\r\n          @click=\"fullScreen(item.image)\"\r\n        />\r\n      </div>\r\n    </template>\r\n  </Modal>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { type Person, type PersonInfo } from \"@/utils\";\r\nimport GenderIcon from \"@/icons/GenderIcon.vue\";\r\nimport Modal from \"./Modal.vue\";\r\nimport { ref } from \"vue\";\r\ndefineProps<{ item: Person }>();\r\n\r\nconst genderName = (gender: number) => {\r\n  return gender ? \"男\" : \"女\";\r\n};\r\n\r\nconst open = ref(false);\r\n\r\nfunction fullScreen(url: string) {\r\n  window.open(url, \"_blank\");\r\n}\r\n\r\nasync function copy(phone: string) {\r\n  await navigator.clipboard.writeText(phone);\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n.image-container {\r\n  text-align: center;\r\n  margin-top: 20px;\r\n\r\n  .image {\r\n    max-height: 200px;\r\n  }\r\n}\r\n\r\narticle {\r\n  border-radius: var(--radius);\r\n  padding: 8px 24px 8px 12px;\r\n  width: max-content;\r\n  white-space: nowrap;\r\n  max-width: 200px;\r\n  margin-left: 12px;\r\n  height: fit-content;\r\n  user-select: none;\r\n  cursor: pointer;\r\n\r\n  &.current {\r\n    box-shadow: 0 0 0 2px var(--gray-900);\r\n  }\r\n\r\n  &:last-child {\r\n    margin-right: calc(var(--margin) / 2);\r\n  }\r\n\r\n  &.male {\r\n    background: linear-gradient(-45deg, var(--primary), var(--primary-light));\r\n  }\r\n\r\n  &.female {\r\n    background: linear-gradient(\r\n      45deg,\r\n      var(--secondary),\r\n      var(--secondary-light)\r\n    );\r\n  }\r\n\r\n  &.unknown {\r\n    background-color: var(--unknown);\r\n  }\r\n\r\n  &.die {\r\n    filter: grayscale(1);\r\n  }\r\n\r\n  header {\r\n    .name {\r\n      font-weight: 500;\r\n    }\r\n\r\n    .pname {\r\n      color: var(--gray-600);\r\n      margin-left: 5px;\r\n      font-weight: normal;\r\n      font-size: 14px;\r\n    }\r\n  }\r\n\r\n  body {\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n\r\n    .item {\r\n      font-size: 12px;\r\n      user-select: none;\r\n      margin-right: 6px;\r\n      margin-top: 6px;\r\n      background-color: var(--transparent-gray-100);\r\n      padding: 3px 5px;\r\n      line-height: 1;\r\n      border-radius: calc(var(--radius) / 2);\r\n\r\n      &:last-child {\r\n        margin-right: 0;\r\n      }\r\n    }\r\n  }\r\n\r\n  footer {\r\n    color: var(--gray-800);\r\n    margin-top: calc(var(--padding) / 4);\r\n    font-size: 12px;\r\n  }\r\n}\r\n</style>\r\n","<template>\r\n  <section :class=\"{ children: item.children?.length && item.showChildren }\">\r\n    <aside>\r\n      <div\r\n        class=\"avatar\"\r\n        :style=\"{\r\n          '--length': avatarName.length + 1,\r\n          cursor: item.children?.length ? 'pointer' : 'default',\r\n        }\"\r\n        @click=\"go(item)\"\r\n        :title=\"item.children?.length ? '点击查看此分支' : ''\"\r\n      >\r\n        {{ avatarName }}\r\n      </div>\r\n      <div\r\n        class=\"close\"\r\n        :class=\"{ open: item.showChildren }\"\r\n        @click=\"item.showChildren = !item.showChildren\"\r\n        v-if=\"item.children?.length\"\r\n      >\r\n        <span class=\"close-text\" v-if=\"!item.showChildren\"\r\n          >展开 {{ item.children?.length }}</span\r\n        >\r\n        <span class=\"close-text\" v-else>收起</span>\r\n      </div>\r\n    </aside>\r\n    <PersonCard :item=\"item\"></PersonCard>\r\n\r\n    <PersonCard\r\n      v-if=\"Array.isArray(item.mate)\"\r\n      v-for=\"mate in item.mate\"\r\n      :key=\"mate.name\"\r\n      :item=\"mate\"\r\n    ></PersonCard>\r\n    <PersonCard v-else-if=\"item.mate\" :item=\"item.mate\"></PersonCard>\r\n  </section>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { type Person } from \"@/utils\";\r\nimport { computed, defineProps } from \"vue\";\r\nimport PersonCard from \"./PersonCard.vue\";\r\nimport { useRouter } from \"vue-router\";\r\nconst { item } = defineProps<{ item: Person }>();\r\nconst router = useRouter();\r\nconst avatarName = computed(() =>\r\n  item.pname\r\n    ? item.pname\r\n    : item.name.length > 1\r\n    ? item.name.slice(1)\r\n    : item.name[0]\r\n);\r\nconst go = (item: Person) => {\r\n  if (item.children?.length) router.push(`/branch/${item.id}`);\r\n};\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\nsection {\r\n  display: flex;\r\n  position: relative;\r\n\r\n  &.children::before {\r\n    position: absolute;\r\n    bottom: -5px;\r\n    left: 20px;\r\n    height: calc(100% - 75px);\r\n    border-left: 1px dashed var(--gray-900);\r\n    animation: opacity 0.5s ease;\r\n\r\n    @keyframes opacity {\r\n      0% {\r\n        opacity: 0;\r\n      }\r\n\r\n      100% {\r\n        opacity: 1;\r\n      }\r\n    }\r\n    content: \"\";\r\n  }\r\n\r\n  aside {\r\n    height: fit-content;\r\n    position: relative;\r\n    .avatar {\r\n      width: 40px;\r\n      height: 40px;\r\n      cursor: pointer;\r\n      user-select: none;\r\n      font-size: calc(40px / var(--length));\r\n      line-height: 40px;\r\n      text-align: center;\r\n      letter-spacing: 0;\r\n      border-radius: 50%;\r\n      color: var(--gray-900);\r\n      position: relative;\r\n      background: linear-gradient(135deg, var(--gray-200), var(--gray-500));\r\n    }\r\n\r\n    .close {\r\n      position: absolute;\r\n      cursor: pointer;\r\n      height: 10px;\r\n      width: 10px;\r\n      left: 50%;\r\n      bottom: -5px;\r\n      transform: translate(-50%, 75%);\r\n      z-index: 0;\r\n\r\n      .close-text {\r\n        display: inline-block;\r\n        user-select: none;\r\n        font-size: 10px;\r\n        position: absolute;\r\n        left: 50%;\r\n        transform: translate(-50%, 100%);\r\n        white-space: nowrap;\r\n      }\r\n\r\n      &.open {\r\n        &::before {\r\n          transform: translate(-50%, 90%) rotate(-135deg);\r\n        }\r\n      }\r\n    }\r\n\r\n    .close::before {\r\n      content: \"\";\r\n      position: absolute;\r\n      bottom: 50%;\r\n      left: 50%;\r\n      transition: transform 0.3s;\r\n      z-index: 0;\r\n      transform: translate(-50%, 25%) rotate(45deg);\r\n      height: 10px;\r\n      width: 10px;\r\n      box-sizing: border-box;\r\n      border: 5px solid var(--gray-300);\r\n      border-top-color: transparent;\r\n      border-left-color: transparent;\r\n    }\r\n  }\r\n}\r\n\r\n.image-container {\r\n  text-align: center;\r\n  margin-top: 10px;\r\n  .image {\r\n    max-height: 200px;\r\n  }\r\n}\r\n</style>\r\n","<template>\r\n  <svg\r\n    t=\"1707552859824\"\r\n    class=\"icon\"\r\n    viewBox=\"0 0 1024 1024\"\r\n    version=\"1.1\"\r\n    xmlns=\"http://www.w3.org/2000/svg\"\r\n    p-id=\"4303\"\r\n    width=\"16\"\r\n    height=\"16\"\r\n  >\r\n    <path\r\n      d=\"M395.21518 513.604544l323.135538-312.373427c19.052938-18.416442 19.052938-48.273447 0-66.660212-19.053961-18.416442-49.910737-18.416442-68.964698 0L291.75176 480.290811c-19.052938 18.416442-19.052938 48.273447 0 66.660212l357.633237 345.688183c9.525957 9.207709 22.01234 13.796214 34.497699 13.796214 12.485359 0 24.971741-4.588505 34.466999-13.82896 19.052938-18.416442 19.052938-48.242747 0-66.660212L395.21518 513.604544z\"\r\n      fill=\"#272636\"\r\n      p-id=\"4304\"\r\n    ></path>\r\n  </svg>\r\n</template>\r\n\r\n<style scoped lang=\"scss\">\r\npath {\r\n  fill: var(--gray-900);\r\n}\r\n</style>\r\n","<template>\r\n    <svg width=\"18\" height=\"18\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" class=\"FhOy97Hs\">\r\n        <path fill-rule=\"evenodd\" clip-rule=\"evenodd\"\r\n            d=\"M7.875 1.5a6.375 6.375 0 103.642 11.608l3.063 3.063a1.125 1.125 0 001.59-1.591l-3.062-3.063A6.375 6.375 0 007.875 1.5zM3.75 7.875a4.125 4.125 0 118.25 0 4.125 4.125 0 01-8.25 0z\"\r\n            fill=\"#4F5168\"></path>\r\n    </svg>\r\n</template>","<template>\r\n  <section>\r\n    <header>\r\n      <i class=\"back\" v-if=\"father\" @click=\"go\">\r\n        <BackIcon></BackIcon>\r\n      </i>\r\n      <div class=\"search-container\">\r\n        <div class=\"prefix\">\r\n          <SearchIcon></SearchIcon>\r\n        </div>\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"请输入关键字\"\r\n          v-model=\"name\"\r\n          class=\"search\"\r\n          @keydown.enter=\"searchFn\"\r\n        />\r\n        <button class=\"suffix\" @click=\"searchFn\">搜索</button>\r\n      </div>\r\n    </header>\r\n    <main class=\"container\" id=\"container\">\r\n      <h3 v-if=\"father\">第{{ level - 1 }}世祖 {{ father.name }} 后裔</h3>\r\n      <List :list=\"list\">\r\n        <template #item=\"{ item }\">\r\n          <PersonItem :item=\"item\" />\r\n        </template>\r\n      </List>\r\n    </main>\r\n  </section>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport List from \"@/components/List.vue\";\r\nimport PersonItem from \"@/components/PersonItem.vue\";\r\nimport BackIcon from \"@/icons/BackIcon.vue\";\r\nimport { ref } from \"vue\";\r\nimport aes from \"@/utils/aes\";\r\nimport { debounce, genealogyList } from \"@/utils\";\r\nimport { listToTree, type Person } from \"@/utils\";\r\nimport SearchIcon from \"@/icons/SearchIcon.vue\";\r\nimport { useRoute, useRouter } from \"vue-router\";\r\nconst name = ref(\"\");\r\nconst route = useRoute();\r\nconst router = useRouter();\r\nconst id = Number(route.params.id || -1);\r\nconst li: Person[] = JSON.parse(aes.decrypt(genealogyList) || \"[]\");\r\nconst father = li.find((item) => item.id === id);\r\n\r\nlet ancestor = father;\r\nlet level = 30;\r\nwhile (ancestor) {\r\n  ancestor = li.find((item) => item.id === ancestor?.pid);\r\n  level++;\r\n}\r\n\r\nfunction go() {\r\n  router.push(`/branch/${father?.pid}`);\r\n}\r\nconst list = ref<Person[]>(\r\n  listToTree(li, id, level).map((item) => ((item.showChildren = true), item))\r\n);\r\n\r\nfunction clearCurrent(nodeList: Person[]) {\r\n  for (const node of nodeList) {\r\n    node.current = false;\r\n    if (node.mate) {\r\n      if (Array.isArray(node.mate))\r\n        node.mate.forEach((mate) => (mate.current = false));\r\n      else node.mate.current = false;\r\n    }\r\n    if (node.children) clearCurrent(node.children);\r\n  }\r\n}\r\n\r\nfunction setShow(nodeList: Person[], show: boolean) {\r\n  for (const node of nodeList) {\r\n    node.show = show;\r\n    if (node.children) setShow(node.children, show);\r\n  }\r\n}\r\n\r\nfunction isFind(p: Person, name: string) {\r\n  if (\r\n    p.name.includes(name) ||\r\n    p.pname?.includes(name) ||\r\n    p.keywords?.some((keyword) => name.toLocaleLowerCase().includes(keyword))\r\n  ) {\r\n    return true;\r\n  }\r\n  return false;\r\n}\r\n\r\nfunction dfs(nodeList: Person[], target_name: string): Person[] {\r\n  const arr = [];\r\n  for (const node of nodeList) {\r\n    if (isFind(node, target_name)) {\r\n      node.current = true;\r\n      node.show = true;\r\n      arr.push(node);\r\n    } else if (node.mate && Array.isArray(node.mate)) {\r\n      for (const mate of node.mate) {\r\n        if (isFind(mate, target_name)) {\r\n          mate.current = true;\r\n          node.show = true;\r\n          arr.push(node);\r\n        }\r\n      }\r\n    } else if (node.mate && !Array.isArray(node.mate)) {\r\n      if (isFind(node.mate, target_name)) {\r\n        node.mate.current = true;\r\n        node.show = true;\r\n        arr.push(node);\r\n      }\r\n    }\r\n    const res = dfs(node.children!, target_name);\r\n    arr.push(...res);\r\n    if (res.length) {\r\n      node.show = true;\r\n      node.showChildren = true;\r\n      arr.push(node);\r\n    } else {\r\n      node.showChildren = false;\r\n    }\r\n  }\r\n  return arr;\r\n}\r\n\r\nfunction search() {\r\n  clearCurrent(list.value);\r\n  if (name.value.trim()) {\r\n    setShow(list.value, false);\r\n    dfs(list.value, name.value.trim());\r\n    setTimeout(() => {\r\n      const current = document.querySelector(\".current\");\r\n      if (current) {\r\n        current.scrollIntoView({ behavior: \"smooth\", block: \"center\" });\r\n      }\r\n    }, 300);\r\n  } else {\r\n    setShow(list.value, true);\r\n  }\r\n}\r\n\r\nconst searchFn = debounce(search, 300);\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\nsection {\r\n  header {\r\n    display: flex;\r\n    margin-left: 20px;\r\n    .back {\r\n      margin-left: -5px;\r\n      margin-right: 10px;\r\n      cursor: pointer;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n    }\r\n    .search-container {\r\n      margin-right: 20px;\r\n      position: relative;\r\n      flex: 1;\r\n\r\n      .prefix {\r\n        position: absolute;\r\n        width: 40px;\r\n        top: 50%;\r\n        transform: translateY(-50%);\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        height: 40px;\r\n      }\r\n\r\n      .search {\r\n        height: 40px;\r\n        width: 100%;\r\n        border-radius: var(--radius);\r\n        border: unset;\r\n        outline: unset;\r\n        background-color: var(--gray-200);\r\n        padding: 0 60px 0 36px;\r\n\r\n        &::placeholder {\r\n          font-family: \"PingFang SC\";\r\n          user-select: none;\r\n        }\r\n      }\r\n\r\n      .suffix {\r\n        position: absolute;\r\n        right: 0;\r\n        top: 50%;\r\n        transform: translateY(-50%);\r\n        height: 40px;\r\n        width: 60px;\r\n        background-color: transparent;\r\n        border: unset;\r\n        cursor: pointer;\r\n        color: var(--primary);\r\n        outline: unset;\r\n        font-family: \"PingFang SC\";\r\n        user-select: none;\r\n      }\r\n    }\r\n  }\r\n\r\n  .container {\r\n    position: relative;\r\n    width: 100%;\r\n    padding-top: 20px;\r\n    padding-bottom: 20px;\r\n    height: calc(100vh - 40px - var(--safe-top) - var(--margin) / 2);\r\n    overflow: auto;\r\n    mask-image: linear-gradient(\r\n      transparent,\r\n      var(--gray-900) 5%,\r\n      var(--gray-900) 95%,\r\n      transparent 100%\r\n    );\r\n\r\n    h3 {\r\n      margin-left: 20px;\r\n      margin-top: 5px;\r\n      width: fit-content;\r\n      margin-bottom: 30px;\r\n      font-weight: bold;\r\n      background: linear-gradient(45deg, var(--primary) 25%, var(--secondary));\r\n      background-clip: text;\r\n      -webkit-background-clip: text;\r\n      -webkit-text-fill-color: transparent;\r\n    }\r\n  }\r\n}\r\n</style>\r\n"],"names":["_hoisted_1","_hoisted_2","_withScopeId","_createElementVNode","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_cache","emit","__emit","close","onMounted","onBeforeUnmount","genderName","gender","open","ref","fullScreen","url","copy","phone","item","__props","router","useRouter","avatarName","computed","go","name","route","useRoute","id","li","aes","genealogyList","father","ancestor","level","list","listToTree","clearCurrent","nodeList","node","mate","setShow","show","isFind","p","_a","_b","keyword","dfs","target_name","arr","res","search","current","searchFn","debounce"],"mappings":"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"}